from timeit import timeit

from celery import Celery

celery = Celery("workbench", broker = "redis://localhost:6379/0")

def main():
  phase0 = {"created":"2017-07-21T10:20:51.346407","_uuid":"4359f05412ed4936a4d8e183347ea838","version":"9.0","components":[{"model":"Mobile 945GSE Express Integrated Graphics Controller","memory":256.0,"@type":"GraphicCard","manufacturer":"Intel Corporation"},{"model":"Mobile 945GM\/GMS\/GME, 943\/940GML Express Integrated Graphics Controller","@type":"GraphicCard","manufacturer":"Intel Corporation"},{"logical_name":"\/dev\/sda","serialNumber":"5SV1W0WF","test":{"status":"Completed without error","firstError":None,"error":False,"lifetime":2129,"type":"Short offline","@type":"TestHardDrive"},"interface":"ata","model":"ST9160310AS","manufacturer":"Seagate","@type":"HardDrive","size":152627.8359375},{"interface":"SDRAM","manufacturer":"Manufacturer0","@type":"RamModule","size":2048},{"totalSlots":1,"serialNumber":"EeePC-0123456789","connectors":{"firewire":0,"serial":0,"pcmcia":0,"usb":5},"model":"1000H","usedSlots":1,"@type":"Motherboard","manufacturer":"ASUSTeK Computer INC."},{"model":"AR8121\/AR8113\/AR8114 Gigabit or Fast Ethernet","serialNumber":"00:23:54:8d:be:66","speed":100,"@type":"NetworkAdapter","manufacturer":"Qualcomm Atheros"},{"model":"RT2790 Wireless 802.11n 1T\/2R PCIe","serialNumber":"00:15:af:dc:44:eb","@type":"NetworkAdapter","manufacturer":"Ralink corp."},{"benchmark":{"score":6383.98,"@type":"BenchmarkProcessor"},"numberOfCores":1,"model":"Intel(R) Atom(TM) CPU N270 @ 1.60GHz","speed":1.6,"@type":"Processor","manufacturer":"Intel Corp."},{"model":"NM10\/ICH7 Family High Definition Audio Controller","@type":"SoundCard","manufacturer":"Intel Corporation"}],"device":{"serialNumber":"8BOAAQ191999","_uuid":"5318e7409797419b9612d183fed966f9","model":"1000H","type":"Desktop","@type":"Computer","manufacturer":"ASUSTeK Computer INC."},"_id":"469","@type":"Snapshot","condition":{"appearance":{"general":"D"},"functionality":{"general":"D"}}}
  phase1 = {"created":"2017-07-21T10:21:09.401626","_uuid":"4359f05412ed4936a4d8e183347ea838","version":"9.0","components":[{"model":"Mobile 945GSE Express Integrated Graphics Controller","memory":256.0,"@type":"GraphicCard","manufacturer":"Intel Corporation"},{"model":"Mobile 945GM\/GMS\/GME, 943\/940GML Express Integrated Graphics Controller","@type":"GraphicCard","manufacturer":"Intel Corporation"},{"serialNumber":"5SV1W0WF","benchmark":{"readingSpeed":68.4,"@type":"BenchmarkHardDrive","writingSpeed":19.5},"test":{"status":"Completed without error","firstError":None,"error":False,"lifetime":2129,"type":"Short offline","@type":"TestHardDrive"},"interface":"ata","model":"ST9160310AS","manufacturer":"Seagate","@type":"HardDrive","size":152627.8359375},{"interface":"SDRAM","manufacturer":"Manufacturer0","@type":"RamModule","size":2048},{"totalSlots":1,"serialNumber":"EeePC-0123456789","connectors":{"firewire":0,"serial":0,"pcmcia":0,"usb":5},"model":"1000H","usedSlots":1,"@type":"Motherboard","manufacturer":"ASUSTeK Computer INC."},{"model":"AR8121\/AR8113\/AR8114 Gigabit or Fast Ethernet","serialNumber":"00:23:54:8d:be:66","speed":100,"@type":"NetworkAdapter","manufacturer":"Qualcomm Atheros"},{"model":"RT2790 Wireless 802.11n 1T\/2R PCIe","serialNumber":"00:15:af:dc:44:eb","@type":"NetworkAdapter","manufacturer":"Ralink corp."},{"benchmark":{"score":6383.98,"@type":"BenchmarkProcessor"},"numberOfCores":1,"model":"Intel(R) Atom(TM) CPU N270 @ 1.60GHz","speed":1.6,"@type":"Processor","manufacturer":"Intel Corp."},{"model":"NM10\/ICH7 Family High Definition Audio Controller","@type":"SoundCard","manufacturer":"Intel Corporation"}],"device":{"serialNumber":"8BOAAQ191999","_uuid":"5318e7409797419b9612d183fed966f9","model":"1000H","type":"Desktop","@type":"Computer","manufacturer":"ASUSTeK Computer INC."},"_id":"469","@type":"Snapshot","condition":{"appearance":{"general":"D"},"functionality":{"general":"D"}}}
  phase2 = {"created":"2017-07-21T10:21:09.645876","_uuid":"4359f05412ed4936a4d8e183347ea838","signed_data":None,"localpath":"\/tmp\/asustek-computer-inc,1000h,8boaaq191999.json","filename":"asustek-computer-inc,1000h,8boaaq191999.json","device":{"_uuid":"5318e7409797419b9612d183fed966f9"}}
  phase3 = {"device":{"_uuid":"5318e7409797419b9612d183fed966f9"},"copy_to_usb":False,"_uuid":"4359f05412ed4936a4d8e183347ea838","inventory":"\/media\/ereuse-data\/inventory","created":"2017-07-21T10:21:09.691107"}
  phase4 = {"device":{"_uuid":"5318e7409797419b9612d183fed966f9"},"stress_test_ok":True,"_uuid":"4359f05412ed4936a4d8e183347ea838","stress_test_mins":1,"created":"2017-07-21T10:22:09.879150"}
  phase5 = {"device":{"_uuid":"5318e7409797419b9612d183fed966f9"},"_uuid":"4359f05412ed4936a4d8e183347ea838","install_image_ok":True,"image_name":"linux-mint-1802-en-gb","created":"2017-07-21T10:31:40.185746"}

  for phase in [phase0, phase1, phase2, phase3, phase4, phase5]:
    celery.send_task("worker.consume_phase", (phase,))

if __name__ == "__main__":
  tI = timeit()
  main()
  tF = timeit()
  print(tF - tI)
